---
phase: 06-component-polish
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - components/ui/progress.tsx
  - components/dashboard/ParentBudgetOverview.tsx
autonomous: true

must_haves:
  truths:
    - Progress bars use 8px height (h-2) matching FreshBooks style
    - Progress bars show percentage value outside/above bar for readability
    - Budget progress bars change color based on thresholds: green <70%, amber 70-90%, red >90%
    - Color transitions are smooth (300ms) not instant/jarring
    - Progress bar colors match corresponding text colors for redundant signaling
    - Percentage text is visible and readable (not buried inside 8px bar)
  artifacts:
    - path: components/ui/progress.tsx
      provides: Progress component with transition-colors for smooth color changes
      contains: 'transition-colors'
    - path: components/dashboard/ParentBudgetOverview.tsx
      provides: Budget progress bar with dynamic color thresholds and smooth transitions
      contains: 'duration-300'
  key_links:
    - from: components/dashboard/ParentBudgetOverview.tsx
      to: Progress component
      via: indicatorClassName prop with dynamic colors
      pattern: 'indicatorClassName.*bg-.*-600'
    - from: Progress bar color
      to: Percentage text color
      via: matching color classes
      pattern: 'percentageUsed >= 90.*bg-red-600.*text-red-600'
---

<objective>
Apply FreshBooks progress bar styling to budget indicators with dynamic color thresholds and smooth transitions

Purpose: Improve budget status visualization with professional, accessible progress bars that clearly communicate spending thresholds through color and animation
Output: Budget progress bars using 8px height, rounded styling, and dynamic green/amber/red colors with 300ms smooth transitions
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/phases/06-component-polish/06-CONTEXT.md
@.planning/phases/06-component-polish/06-RESEARCH.md

# Current Progress component (needs transition-colors for smooth color changes)

@components/ui/progress.tsx

# Component using budget progress bars (needs threshold updates and smooth transitions)

@components/dashboard/ParentBudgetOverview.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add smooth color transitions to Progress component</name>
  <files>components/ui/progress.tsx</files>
  <action>
Update Progress component indicator to include smooth color transitions:

**Line 26: Update indicatorClassName default to include transition-colors:**

Change from:

```tsx
className={cn("h-full w-full flex-1 bg-primary transition-all", indicatorClassName)}
```

To:

```tsx
className={cn("h-full w-full flex-1 bg-primary transition-all duration-300", indicatorClassName)}
```

Why this change:

- transition-all already exists but duration-300 makes transitions smoother
- When indicatorClassName changes color (green → amber → red), color change animates over 300ms
- Prevents jarring instant color changes when crossing thresholds
- FreshBooks pattern: smooth, professional animations

**Note about transition behavior:**

- transition-all applies to transform (progress fill animation) AND color changes
- duration-300 = 300ms for both fill and color transitions
- When budget percentage crosses threshold (e.g., 69% → 71%), color smoothly fades from green to amber
- This is superior to instant color snap which feels abrupt

Do NOT change other parts of the component. Only add duration-300 to the existing transition-all.
</action>
<verify>
Run: `npm run build` to confirm TypeScript compilation
Check: Progress indicator includes "transition-all duration-300" classes
Confirm: No breaking changes to Progress API
</verify>
<done>
Progress component includes duration-300 for smooth 300ms color transitions
TypeScript builds without errors
Progress component ready for dynamic color usage
</done>
</task>

<task type="auto">
  <name>Task 2: Update budget progress bar with FreshBooks styling and 70/90 thresholds</name>
  <files>components/dashboard/ParentBudgetOverview.tsx</files>
  <action>
Update budget progress bar to use FreshBooks styling (8px height, smooth transitions, 70/90 thresholds):

**Lines 29-52: Update getBudgetStatus thresholds from 95/85 to 90/70:**

Change threshold logic:

FROM:

```tsx
if (percentageUsed >= 95) {
  return {
    label: 'Over Budget',
    variant: 'destructive' as const,
    icon: AlertTriangle,
    color: 'text-red-600',
  }
} else if (percentageUsed >= 85) {
  return {
    label: 'Watch',
    variant: 'warning' as const,
    icon: AlertTriangle,
    color: 'text-amber-600',
  }
} else {
  return {
    label: 'On Track',
    variant: 'success' as const,
    icon: CheckCircle2,
    color: 'text-green-600',
  }
}
```

TO:

```tsx
if (percentageUsed >= 90) {
  return {
    label: 'Over Budget',
    variant: 'destructive' as const,
    icon: AlertTriangle,
    color: 'text-red-600',
  }
} else if (percentageUsed >= 70) {
  return {
    label: 'Watch',
    variant: 'warning' as const,
    icon: AlertTriangle,
    color: 'text-amber-600',
  }
} else {
  return {
    label: 'On Track',
    variant: 'success' as const,
    icon: CheckCircle2,
    color: 'text-green-600',
  }
}
```

**Line 88-98: Update Progress bar styling and color logic:**

Change from:

```tsx
<Progress
  value={Math.min(percentageUsed, 100)}
  className="h-3"
  indicatorClassName={
    percentageUsed >= 95 ? 'bg-red-600' : percentageUsed >= 85 ? 'bg-amber-600' : undefined
  }
/>
```

To:

```tsx
<Progress
  value={Math.min(percentageUsed, 100)}
  className="h-2"
  indicatorClassName={cn(
    'transition-colors duration-300',
    percentageUsed >= 90 ? 'bg-red-600' : percentageUsed >= 70 ? 'bg-amber-600' : 'bg-green-600'
  )}
/>
```

Changes:

- h-3 → h-2 (12px → 8px) per FreshBooks style and requirements
- Added cn() wrapper for class merging
- Added explicit transition-colors duration-300 (belt-and-suspenders with base component)
- Thresholds: 95/85 → 90/70 per requirements
- Added explicit bg-green-600 for green state (instead of undefined/default)
- Must import cn from @/lib/utils if not already imported

**Verify cn import at top of file:**
If not present, add to imports:

```tsx
import { cn } from '@/lib/utils'
```

**Line 100: Update percentage text color to match new thresholds:**

The status.color variable is already dynamic based on getBudgetStatus(), so it will automatically use the new 90/70 thresholds. No change needed to the percentage text line itself.

**Lines 115-133: Update category progress bars to use smooth transitions:**

Category progress bars also need smooth color transitions:

Change from (line 128-132):

```tsx
<Progress
  value={Math.min(categoryPercentage, 100)}
  className="h-1.5"
  indicatorClassName={isOverBudget ? 'bg-red-600' : undefined}
/>
```

To:

```tsx
<Progress
  value={Math.min(categoryPercentage, 100)}
  className="h-1.5"
  indicatorClassName={cn(
    'transition-colors duration-300',
    isOverBudget ? 'bg-red-600' : 'bg-green-600'
  )}
/>
```

Changes:

- Added cn() wrapper
- Added transition-colors duration-300 for smooth color changes
- Added explicit bg-green-600 for under-budget state (instead of undefined)

Why these changes:

- h-2 (8px) matches FreshBooks compact, professional style
- 70/90 thresholds per requirements and context decisions
- Smooth 300ms transitions prevent jarring color snaps
- Explicit green/amber/red colors provide redundant signaling with text
- Category bars also get smooth transitions for consistency
  </action>
  <verify>
  Run: `npm run build` to confirm TypeScript compilation
  Check: Overall progress bar uses h-2 className (8px height)
  Check: Progress indicatorClassName includes transition-colors duration-300
  Check: Thresholds updated to 90/70 (getBudgetStatus and Progress conditions)
  Check: Category progress bars also include transition-colors
  Check: cn utility imported from @/lib/utils
  Visual check: Progress bars appear thinner (8px vs previous 12px)
  </verify>
  <done>
  Budget progress bars use h-2 (8px) height matching FreshBooks style
  Color thresholds updated to 70/90 per requirements
  Smooth 300ms color transitions prevent jarring changes
  Green/amber/red colors explicitly defined for all states
  Category progress bars also use smooth transitions
  TypeScript builds without errors
  </done>
  </task>

</tasks>

<verification>
**Visual Verification:**

1. **Progress Bar Styling:**
   - Navigate to parent dashboard with budget data
   - Verify overall budget progress bar is visibly thinner (8px vs 12px)
   - Verify progress bar has rounded ends (rounded-full)
   - Verify percentage value is outside/above bar (not inside 8px bar)

2. **Color Threshold Testing:**
   - Find team with <70% budget usage → progress bar should be green
   - Find team with 70-90% usage → progress bar should be amber
   - Find team with >90% usage → progress bar should be red
   - Verify badge color matches progress bar color (green/amber/red consistency)

3. **Transition Smoothness:**
   - If possible, watch budget percentage cross threshold (e.g., 69% → 71%)
   - Color should fade smoothly from green to amber (300ms)
   - NOT instant snap from green to amber
   - Note: May need to manually test or create demo data at threshold boundary

4. **Category Progress Bars:**
   - Verify category breakdown bars also show smooth transitions
   - Check that over-budget categories show red, under-budget show green

**Accessibility Verification:**

1. **Color + Text Redundancy:**
   - Progress bar green matches "On Track" badge
   - Progress bar amber matches "Watch" badge
   - Progress bar red matches "Over Budget" badge
   - Color-blind users can rely on badge text even if colors indistinguishable

2. **Readability:**
   - Percentage text clearly visible outside bar
   - Text color matches bar color for reinforcement
   - Remaining amount shown alongside percentage

**Build Verification:**

```bash
npm run build
```

Must succeed with no TypeScript errors.
</verification>

<success_criteria>

- Progress bars use h-2 (8px) height throughout ParentBudgetOverview
- Budget status thresholds updated to 70% (amber) and 90% (red)
- Progress indicator includes transition-colors duration-300 for smooth animations
- Green/amber/red colors explicitly defined (not undefined/default)
- Category progress bars also use smooth color transitions
- Percentage value displayed outside/above bar for readability
- Progress bar colors match badge colors for redundant signaling
- TypeScript builds without errors
- Visual check confirms thinner bars and smooth color transitions
  </success_criteria>

<output>
After completion, create `.planning/phases/06-component-polish/06-02-SUMMARY.md`
</output>
